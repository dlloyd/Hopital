{% extends 'base.html.twig' %}


{% block body %}

<div class="container">
  <h2> Equipement </h2>

  
  <br/><br/>
  <input id="myInput"  placeholder="Recherche.." > <br/><br/>
           
  <table class="table table-striped">
    <thead>
      <tr>
      	<th> Code  </th>
        <th> Equipement </th>
        <th> Catégorie </th>
        <th> Etat </th>
        <th> Stock </th>
        <th> Service </th>
        <th> Réparé/En panne</th>
        <th> Liste réparations </th>
        
      </tr>
    </thead>
    <tbody id="myTable">
    {% for equipment in equipments %}
      <tr>
        <td> {{ equipment.code }} </td>
        <td> {{ equipment.name }} </td>
        <td> {{ equipment.category.name }} </td>
        <td> {% if equipment.isBroken %} En panne {% else %} Fonctionne {% endif %} </td>
        <td> {% if equipment.stock != null %} {{ equipment.stock.id }} {% endif %} </td>
        <td> {% if equipment.service != null  %} {{ equipment.service.name }} {% endif %} </td>
        
        <td> {% if equipment.isBroken == true %}
              <a href=" {{ path('ho_equipment_reparation', {'id': equipment.id}) }} " class="btn btn-default btn-success" > Valider réparation </a>
             {% else %}
              <a href="{{ path('ho_equipment_broken', {'id': equipment.id}) }}" class="btn btn-default btn-danger" > Signaler panne </a> 
             {% endif %}
         </td>
        <td> 
        {% if equipment.reparations is not empty %}
         <a href="#" data-toggle="modal" data-target="#myModal{{equipment.id}}" class="btn btn-default btn-primary" > Voir Détails </a> 

         
          <!--  MODAL REPARATIONS    -->
               <div class="modal fade" id="myModal{{equipment.id}}" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
                     <div class="modal-dialog" role="document">
                      <div class="modal-content">
                        <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal">&times;</button>
                <h4 class="modal-title"> Liste des réparations </h4>
              </div>

              <div class="modal-body" style="font-size:16px">
                    
              <div class="form-group">

              <div class="input-group col-xs-7">
                {% for reparation in equipment.reparations  %}
                Problème : {{ reparation.comment }} </br>
                Réparateur : {{ reparation.repairer.username }} <br/>
                Date : {{ reparation.date }}
                <hr>
                {% endfor %}
              </div>
              </div>

              </div>

              <div class="modal-footer" >
              </div>

              </div>
              </div>
              </div>
              <!-- FIN MODAL -->
             
        {% endif %} </td>
        
      </tr>
    {% endfor %}
      
    </tbody>
  </table>
</div>
 <br/><br/><br/><br/><br/>
<script>
$(document).ready(function(){
	$("#myInput").on("keyup", function(){
	var value = $(this).val().toLowerCase();

	$("#myTable tr").each(function(){
	 $(this).toggle($(this).text().toLowerCase().indexOf(value) > -1)
	});
	});
});

</script>



{% endblock %}